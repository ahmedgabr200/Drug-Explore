(this.webpackJsonpdrug_mlvis=this.webpackJsonpdrug_mlvis||[]).push([[0],{163:function(e,t,a){},237:function(e,t,a){e.exports=a(270)},242:function(e,t,a){},264:function(e,t,a){},267:function(e,t,a){},268:function(e,t,a){},270:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(24),o=a.n(i),s=(a(242),a(27)),c=a(28),l=a(33),d=a(31),u=a(30),h=a(278),p=a(129),g=a(25),f=a.n(g),m=a(44),y=a(165),v=a.n(y).a.create({baseURL:"".concat("./","/"),withCredentials:!1,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET,PUT,POST,DELETE,PATCH,OPTIONS"}}),b=function(){var e=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"./data/node_types.json",e.next=3,v.get("./data/node_types.json");case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"./data/edge_types.json",e.next=3,v.get("./data/edge_types.json");case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"./data/node_name_dict.json",e.next=3,v.get("./data/node_name_dict.json");case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(m.a)(f.a.mark((function e(t,a){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="./api/attention_pair?disease=".concat(t,"&drug=").concat(a),e.next=3,v.get(n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),D=function(){var e=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"./api/diseases",e.next=3,v.get("./api/diseases");case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(m.a)(f.a.mark((function e(t){var a,n,r,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="./api/drug_predictions?disease_id=".concat(t),e.next=3,v.get(a);case 3:return n=e.sent,r=n.data,i=r.predictions,o=r.metapath_summary,e.abrupt("return",{predictions:i,metapathSummary:o});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"./data/drug_tsne.json",e.next=3,v.get("./data/drug_tsne.json");case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=a(13),N=a(107),w="Load_Node_Types",I="Load_Edge_Types",j="Add_Attention_Paths",S="Del_Attention_Paths",P="Load_Node_Name_Dict",G="Load_Drug_Options",A="Load_Disease_Options",H="Set_Loading_Status",L="Change_Edge_THR",C="Change_Drug",M="Change_Disease",R="Select_Path_Nodes",U="Toggle_Meta_Path_Hide",W=function(e,t,a,n){t&&(z(e,t,a,n),V(e,n))},z=function(e,t,a,n){void 0!==e&&void 0!==t&&(a?(n({type:H,payload:{isAttentionLoading:!0}}),k(t,e).then((function(t){n({type:j,payload:{attention:t.attention,metaPathGroups:Object(N.a)({},e,Y(t.metapaths))}})})).then((function(){n({type:H,payload:{isAttentionLoading:!1}})}))):n({type:S,payload:{selectedDrug:e}}))},V=function(e,t){t({type:C,payload:{selectedDrug:e}})},Y=function(e){var t=[],a=[];return e.forEach((function(e){e.hide=!1;var n=e.nodes.map((function(e){return e.nodeType})).join("_"),r=a.indexOf(n);r>-1?t[r].metaPaths.push(e):(a.push(n),t.push({nodeTypes:e.nodes.map((function(e){return e.nodeType})),metaPaths:[e]}))})),t},Z=function(e,t){return e.map((function(e){return Object(T.a)(Object(T.a)({},e),{},{selected:t===e.id?!e.selected:e.selected})}))},F=function(e,t){return!e.filter((function(e){return e.selected})).map((function(e){return e.id})).includes(t)},J=function(e,t){switch(t.type){case G:return Object(T.a)(Object(T.a)({},e),{},{drugPredictions:t.payload.drugPredictions,metaPathSummary:t.payload.metaPathSummary.map((function(e,t){return Object(T.a)(Object(T.a)({},e),{},{hide:!1,idx:t})}))});case A:return Object(T.a)(Object(T.a)({},e),{},{diseaseOptions:t.payload.diseaseOptions});case w:return Object(T.a)(Object(T.a)({},e),{},{nodeTypes:t.payload.nodeTypes});case I:return Object(T.a)(Object(T.a)({},e),{},{edgeTypes:t.payload.edgeTypes});case M:return Object(T.a)(Object(T.a)({},e),{},{selectedDisease:t.payload.selectedDisease,attention:{},metaPathGroups:{}});case C:return Object(T.a)(Object(T.a)({},e),{},{drugPredictions:Z(e.drugPredictions,t.payload.selectedDrug)});case P:return Object(T.a)(Object(T.a)({},e),{},{nodeNameDict:t.payload.nodeNameDict});case H:return Object(T.a)(Object(T.a)({},e),t.payload);case R:return Object(T.a)(Object(T.a)({},e),{},{selectedPathNodes:t.payload.selectedPathNodes});case L:return Object(T.a)(Object(T.a)({},e),{},{edgeThreshold:t.payload.edgeThreshold});case U:return Object(T.a)(Object(T.a)({},e),{},{metaPathSummary:t.payload.metaPathSummary});case j:return Object(T.a)(Object(T.a)({},e),{},{attention:Object(T.a)(Object(T.a)({},e.attention),t.payload.attention),metaPathGroups:Object(T.a)(Object(T.a)({},e.metaPathGroups),t.payload.metaPathGroups)});case S:var a=JSON.parse(JSON.stringify(e.attention)),n=JSON.parse(JSON.stringify(e.metaPathGroups));return delete a["drug:".concat(t.payload.selectedDrug)],delete n[t.payload.selectedDrug],Object(T.a)(Object(T.a)({},e),{},{attention:a,metaPathGroups:n});default:return e}},B={diseaseOptions:[],drugPredictions:[],nodeTypes:[],edgeTypes:{},metaPathGroups:{},attention:{},selectedDisease:void 0,nodeNameDict:{},isDrugLoading:!1,isAttentionLoading:!1,isDiseaseLoading:!1,edgeThreshold:0,metaPathSummary:[],selectedPathNodes:[]},X=Object(n.createContext)({});function q(e){var t=r.a.useReducer(J,B),a=Object(p.a)(t,2),n=a[0],i=a[1],o=r.a.useCallback(function(e,t){return function(a){return"function"===typeof a?a(e,t):e(a)}}(i,n),[]);return r.a.createElement(X.Provider,{value:{state:n,dispatch:o}},e.children)}function K(e){return function(t){return r.a.createElement(X.Consumer,null,(function(a){return r.a.createElement(e,Object.assign({},t,{globalState:a.state,dispatch:a.dispatch}))}))}}var $=a(15),Q=["#4e79a7","#edc949","#e15759","#f28e2c","#76b7b2","#59a14f","#af7aa1","#ff9da7","#9c755f","#bab0ab"],ee={},te=function(e){return void 0===ee[e]&&(ee[e]=Q[Object.keys(ee).length]),ee[e]},ae=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:800,r=e,i=document.createElement("canvas").getContext("2d");i.font="".concat(n," ").concat(t,"px Arial");var o=i.measureText(e).width;if(o>a)for(var s=1;s<e.length;s+=1){var c=e.substr(0,s-1).concat("..."),l=e.substr(0,s).concat("..."),d=i.measureText(c).width,u=i.measureText(l).width;if(u>a&&d<a){r=c;break}}return r},ne=r.a.createElement("g",null,r.a.createElement("text",{textAnchor:"middle",x:"24"},"LOADING..."),r.a.createElement("rect",{x:"0",y:"50",width:"14",height:"30",fill:"#1890ff"},r.a.createElement("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0",dur:"0.6s",repeatCount:"indefinite"})),r.a.createElement("rect",{x:"20",y:"50",width:"14",height:"30",fill:"#1890ff"},r.a.createElement("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0.2s",dur:"0.6s",repeatCount:"indefinite"})),r.a.createElement("rect",{x:"40",y:"50",width:"14",height:"30",fill:"#1890ff"},r.a.createElement("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0.4s",dur:"0.6s",repeatCount:"indefinite"}))),re=function e(t,a){return t.children.length>0&&(t=Object(T.a)(Object(T.a)({},t),{},{children:t.children.filter((function(e){return e.score>=a})).map((function(t){return e(t,a)}))})),t},ie=a(47),oe=a(161),se=a(164),ce=a(166),le=a.n(ce),de=K(function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).circleRadius=3,n.hoverTimeout=0,n.WAIT=500,n.state={embedding:{},tooltip:{visible:!1,info:"",position:[0,0]}},n.onChangeDrug=n.onChangeDrug.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"loadEmbedding",value:function(){var e=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:t=e.sent,this.setState({embedding:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.loadEmbedding()}},{key:"addLasso",value:function(e,t){var a=this,n=this.props.globalState.drugPredictions.filter((function(e){return e.selected})).map((function(e){return e.id}));$.l("g.lasso").remove();var r=$.k("svg.scatter"),i=$.k("rect.lasso"),o=function(){var e,t=[],a=75,n=!0,r=!1,i=!0,o={start:function(){},draw:function(){},end:function(){}};function s(s){var c,l,d,u,h=s.append("g").attr("class","lasso"),p=h.append("path").attr("class","drawn"),g=h.append("path").attr("class","loop_close"),f=h.append("circle").attr("class","origin"),m=se.a().on("start",(function(){u=[],c="",p.attr("d",null),g.attr("d",null),t.nodes().forEach((function(e){e.__lasso.possible=!1,e.__lasso.selected=!1,e.__lasso.hoverSelect=!1,e.__lasso.loopSelect=!1;var t=e.getBoundingClientRect();e.__lasso.lassoPoint=[Math.round(t.left+t.width/2),Math.round(t.top+t.height/2)]})),i&&t.on("mouseover.lasso",(function(){this.__lasso.hoverSelect=!0}));o.start()})).on("drag",(function(){var e,i;"touchmove"===ie.c.sourceEvent.type?(e=ie.c.sourceEvent.touches[0].clientX,i=ie.c.sourceEvent.touches[0].clientY):(e=ie.c.sourceEvent.clientX,i=ie.c.sourceEvent.clientY);var s=oe.a(this)[0],h=oe.a(this)[1];""===c?(c=c+"M "+s+" "+h,l=[e,i],d=[s,h],f.attr("cx",s).attr("cy",h).attr("r",7).attr("display",null)):c=c+" L "+s+" "+h;u.push([e,i]);var m=Math.sqrt(Math.pow(e-l[0],2)+Math.pow(i-l[1],2)),y="M "+s+" "+h+" L "+d[0]+" "+d[1];p.attr("d",c),g.attr("d",y),(r=m<=a)&&n?g.attr("display",null):g.attr("display","none");t.nodes().forEach((function(e){e.__lasso.loopSelect=!!(r&&n&&e.__lasso.lassoPoint)&&le()(u,e.__lasso.lassoPoint)<1,e.__lasso.possible=e.__lasso.hoverSelect||e.__lasso.loopSelect})),o.draw()})).on("end",(function(){t.on("mouseover.lasso",null),t.nodes().forEach((function(e){e.__lasso.selected=e.__lasso.possible,e.__lasso.possible=!1})),p.attr("d",null),g.attr("d",null),f.attr("display","none"),o.end()}));e.call(m)}return s.items=function(e){if(!arguments.length)return t;var a=(t=e).nodes();return a.forEach((function(e){e.__lasso={possible:!1,selected:!1}})),s},s.possibleItems=function(){return t.filter((function(){return this.__lasso.possible}))},s.selectedItems=function(){return t.filter((function(){return this.__lasso.selected}))},s.notPossibleItems=function(){return t.filter((function(){return!this.__lasso.possible}))},s.notSelectedItems=function(){return t.filter((function(){return!this.__lasso.selected}))},s.closePathDistance=function(e){return arguments.length?(a=e,s):a},s.closePathSelect=function(e){return arguments.length?(n=!0===e,s):n},s.isPathClosed=function(e){return arguments.length?(r=!0===e,s):r},s.hoverSelect=function(e){return arguments.length?(i=!0===e,s):i},s.on=function(e,t){if(!arguments.length)return o;if(1===arguments.length)return o[e];var a=["start","draw","end"];return a.indexOf(e)>-1&&(o[e]=t),s},s.targetArea=function(t){return arguments.length?(e=t,s):e},s}();o.items(r.selectAll("circle.highlighted")),o.targetArea(i).on("start",(function(){})).on("draw",(function(){})).on("end",(function(){o.selectedItems()._groups[0].forEach((function(e){var t=e.attributes.id.value;n.includes(t)||W(t,a.props.globalState.selectedDisease,!0,a.props.dispatch)}))})),r.call(o)}},{key:"drawScatter",value:function(){var e=this,t=this.props.globalState.drugPredictions,a=this.props,n=a.width,i=a.height;this.addLasso(n,i);var o=this.state.embedding,s=$.c(Object.values(o).map((function(e){return e[0]}))),c=$.c(Object.values(o).map((function(e){return e[1]}))),l=$.j().domain(s).range([this.circleRadius,n-this.circleRadius]),d=$.j().domain(c).range([this.circleRadius,i-this.circleRadius]),u=t.map((function(e){return e.id})),h=t.filter((function(e){return e.selected})).map((function(e){return e.id}));return Object.keys(o).sort((function(e,t){return u.indexOf(e)-u.indexOf(t)})).map((function(t){var a=Object(p.a)(o[t],2),n=a[0],i=a[1],s=u.indexOf(t)>-1,c=h.includes(t);return r.a.createElement("circle",{cx:l(n),cy:d(i),key:t,className:s?"highlighted drug":"drug",id:t,fill:c?"dark":s?"#1890ff":"lightGray",stroke:"white",r:s?1.5*e.circleRadius:e.circleRadius,onDoubleClick:function(){s&&e.onChangeDrug(t)},onClick:function(){return e.showTooltip(t,[l(n),d(i)])}})}))}},{key:"onChangeDrug",value:function(e){var t=F(this.props.globalState.drugPredictions,e);W(e,this.props.globalState.selectedDisease,t,this.props.dispatch)}},{key:"showTooltip",value:function(e,t){var a=this,n=this.props.globalState.nodeNameDict;this.hoverTimeout=window.setTimeout((function(){a.setState({tooltip:{visible:!0,info:"drug: ".concat(n.drug[e]),position:t}})}),this.WAIT)}},{key:"hideTooltip",value:function(){window.clearTimeout(this.hoverTimeout),this.setState({tooltip:{visible:!1,info:"",position:[0,0]}})}},{key:"render",value:function(){var e=this.props.globalState,t=e.isDrugLoading,a=e.selectedDisease,n=this.props,i=n.width,o=n.height,s=this.state.tooltip;return r.a.createElement("div",{style:{position:"relative"}},r.a.createElement("svg",{width:i,height:o,className:"scatter"},r.a.createElement("rect",{className:"lasso area",width:i,height:o,opacity:0}),r.a.createElement("g",{className:"scatter"},a?this.state.embedding?this.drawScatter():r.a.createElement("g",{transform:"translate(".concat(i/2,", ").concat(o/2,")"),textAnchor:"middle"},ne):r.a.createElement("text",{x:i/2,y:o/2,fill:"gray"},"Please select a disease first"),t?r.a.createElement("g",{transform:"translate(".concat(i/2,", ").concat(o/2,")"),textAnchor:"middle"},ne):r.a.createElement("g",null))," "),r.a.createElement("div",{className:"tooltip tooltip-".concat(s.visible?"show":"hide"),style:{left:s.position[0]+this.circleRadius,top:s.position[1]+this.circleRadius}},s.info))}}]),a}(r.a.Component)),ue=(a(264),function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).TITLE_HEIGHT=36,e.MARGIN=10,e.PADDING=10,e}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.width,a=e.height,n=a-2*this.PADDING-this.TITLE_HEIGHT;return r.a.createElement(h.a,{size:"small",title:"Drug Embeddings",style:{width:t-2*this.MARGIN,height:a,margin:"0px ".concat(this.MARGIN,"px")},bodyStyle:{padding:this.PADDING,height:a-this.TITLE_HEIGHT,overflowY:"auto"},headStyle:{height:this.TITLE_HEIGHT}},r.a.createElement(de,{width:t-2*this.PADDING-2*this.MARGIN,height:n}))}}]),a}(r.a.Component)),he=a(144),pe=a(66),ge=a(178),fe=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).nodeHeight=20,e.fontSize=14,e.labelLength=150,e.midGap=60,e}return Object(c.a)(a,[{key:"drawNodeAttentionHorizontal",value:function(e,t,a){var n=this,i=this.props.width,o=this.props.globalState,s=o.nodeNameDict,c=o.edgeTypes,l=o.selectedPathNodes,d=re(e,a),u=$.h(d),h=$.m().nodeSize([this.nodeHeight+2,t])(u),p=$.i().source((function(e){return{x:"drug"===h.data.nodeType?i/2-n.midGap/2-n.labelLength-e.source.y-n.labelLength/2:e.source.y+n.labelLength/2,y:e.source.x}})).target((function(e){return{x:"drug"===h.data.nodeType?i/2-n.midGap/2-n.labelLength-e.target.y+n.labelLength/2:e.target.y-n.labelLength/2,y:e.target.x}})).x((function(e){return e.x})).y((function(e){return e.y})),g=Math.max.apply(Math,Object(pe.a)(h.links().map((function(e){return e.target.data.score})))),f=$.j().domain([0,g]).range([1,5]),m=h.links().map((function(e,t){var a=e.target.data.edgeInfo.replace("rev_","");return c[a]&&(a=c[a].edgeInfo||a),r.a.createElement(ge.a,{title:a,key:"".concat(e.source.data.nodeId,"=>").concat(e.target.data.nodeId,"_link").concat(t),destroyTooltipOnHide:!0},r.a.createElement("g",null,r.a.createElement("path",{d:p(e),className:"link ".concat(e.source.data.nodeId,"=>").concat(e.target.data.nodeId),fill:"none",stroke:"gray",strokeWidth:f(e.target.data.score),opacity:l.length>0?.5:1}),r.a.createElement("path",{d:p(e),className:"mask",fill:"none",stroke:"transparent",strokeWidth:"3"})))})),y=h.descendants().map((function(e){return e.x})),v=Math.min.apply(Math,Object(pe.a)(y)),b=Math.max.apply(Math,Object(pe.a)(y))-v+this.nodeHeight+4,E=h.descendants().map((function(e,t){var a=e.data,o=a.nodeId,c=a.nodeType,d=s[c][o];void 0===d&&(o=o.replace(/_/g,"")+".0",d=s[c][o]);var u=ae(d,12,n.labelLength-25-function(e,t){var a=document.createElement("canvas").getContext("2d");return a.font="".concat(t,"px Arial"),a.measureText(e).width}("..(0.00)",14)),p=(null===u||void 0===u?void 0:u.includes(".."))?d:"",g="";"disease"===c&&(g="M 483.55 227.55 H 462 c -50.68 0 -76.07 -61.27 -40.23 -97.11 L 437 115.19 A 28.44 28.44 0 0 0 396.8 75 L 381.56 90.22 c -35.84 35.83 -97.11 10.45 -97.11 -40.23 V 28.44 a 28.45 28.45 0 0 0 -56.9 0 V 50 c 0 50.68 -61.27 76.06 -97.11 40.23 L 115.2 75 A 28.44 28.44 0 0 0 75 115.19 l 15.25 15.25 c 35.84 35.84 10.45 97.11 -40.23 97.11 H 28.45 a 28.45 28.45 0 1 0 0 56.89 H 50 c 50.68 0 76.07 61.28 40.23 97.12 L 75 396.8 A 28.45 28.45 0 0 0 115.2 437 l 15.24 -15.25 c 35.84 -35.84 97.11 -10.45 97.11 40.23 v 21.54 a 28.45 28.45 0 0 0 56.9 0 V 462 c 0 -50.68 61.27 -76.07 97.11 -40.23 L 396.8 437 A 28.45 28.45 0 0 0 437 396.8 l -15.25 -15.24 c -35.84 -35.84 -10.45 -97.12 40.23 -97.12 h 21.54 a 28.45 28.45 0 1 0 0 -56.89 Z M 224 272 a 48 48 0 1 1 48 -48 A 48 48 0 0 1 224 272 Z m 80 56 a 24 24 0 1 1 24 -24 A 24 24 0 0 1 304 328 Z"),"drug"===c&&(g="M 555.3 300.1 L 424.2 112.8 C 401.9 81 366.4 64 330.4 64 c -22.6 0 -45.5 6.7 -65.5 20.7 c -19.7 13.8 -33.7 32.8 -41.5 53.8 C 220.5 79.2 172 32 112 32 C 50.1 32 0 82.1 0 144 v 224 c 0 61.9 50.1 112 112 112 s 112 -50.1 112 -112 V 218.9 c 3.3 8.6 7.3 17.1 12.8 25 L 368 431.2 c 22.2 31.8 57.7 48.8 93.8 48.8 c 22.7 0 45.5 -6.7 65.5 -20.7 c 51.7 -36.2 64.2 -107.5 28 -159.2 Z M 160 256 H 64 V 144 c 0 -26.5 21.5 -48 48 -48 s 48 21.5 48 48 v 112 Z m 194.8 44.9 l -65.6 -93.7 c -7.7 -11 -10.7 -24.4 -8.3 -37.6 c 2.3 -13.2 9.7 -24.8 20.7 -32.5 c 8.5 -6 18.5 -9.1 28.8 -9.1 c 16.5 0 31.9 8 41.3 21.5 l 65.6 93.7 l -82.5 57.7 Z");var f=0===l.length||l.map((function(e){return e.nodeType})).includes(c)&&l.map((function(e){return e.nodeId})).includes(o);return r.a.createElement(ge.a,{title:p,key:"node".concat(t,"_").concat(d),destroyTooltipOnHide:!0,mouseEnterDelay:.3},r.a.createElement("g",{className:"".concat(o," node"),transform:"translate(".concat("drug"===h.data.nodeType?i/2-n.midGap/2-n.labelLength-e.y:e.y,", ").concat(e.x,")"),cursor:"pointer"},r.a.createElement("rect",{width:n.labelLength,height:n.nodeHeight,fill:te(c),x:-1*n.labelLength/2,y:-n.nodeHeight/2,opacity:f?1:.2}),r.a.createElement("path",{className:"virus_icon",d:g,transform:"translate(".concat(-1*n.labelLength/2+2,", ").concat(-n.nodeHeight/2,") scale(0.04)"),fill:"white"}),r.a.createElement("text",{fill:"white",fontSize:n.fontSize,transform:"translate(".concat(-1*n.labelLength/2+25,", ").concat((n.nodeHeight-n.fontSize)/2,")")},u)))}));return{content:[r.a.createElement("g",{key:"links",className:"links"},m),r.a.createElement("g",{key:"nodes",className:"nodes"},E)],height:b}}},{key:"drawSubgraph",value:function(){var e=this,t=this.props.globalState,a=t.attention,n=t.edgeThreshold,i=this.props.width,o=(i-2*this.labelLength-this.midGap)/4,s=[0];return{content:Object.keys(a).map((function(t,c){var l=e.drawNodeAttentionHorizontal(a[t],o,n),d=l.height,u=l.content;return s.push(d),r.a.createElement("g",{className:t,key:t,transform:"translate(".concat((i+e.midGap)/2*c+e.labelLength/2,", ").concat(d/2+2*e.nodeHeight,")")},u)})),height:Math.max.apply(Math,s)}}},{key:"render",value:function(){var e=this.props,t=e.width,a=e.height,n=e.globalState,i=n.isAttentionLoading,o=n.selectedDisease,s=n.drugPredictions.filter((function(e){return e.selected})),c=this.drawSubgraph(),l=c.content,d=c.height;return r.a.createElement("svg",{width:t,height:Math.max(d,a),className:"nodeLink"},s.length>0&&o?l:r.a.createElement("text",{x:t/2,y:a/2,fill:"gray"},"Please select a disease and a drug first"),i?r.a.createElement("g",{transform:"translate(".concat(t/2,", ").concat(a/2,")"),textAnchor:"middle"},ne):r.a.createElement("g",null))}}]),a}(r.a.Component),me=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).padding=20,e.RADIUS=8,e.prevNodes=[],e.prevLinks=[],e.simulation=$.g().force("charge",$.f().strength(-170)).force("link",$.e().id((function(e){return e.id})).distance(6).strength(.6)).force("collision",$.d().radius(e.RADIUS+2)).alphaMin(.05),e}return Object(c.a)(a,[{key:"ticked",value:function(e,t){e.attr("transform",(function(e){return"translate(".concat(e.x,", ").concat(e.y,")")})),t.select("line.link").attr("x1",(function(e){return e.source.x})).attr("y1",(function(e){return e.source.y})).attr("x2",(function(e){return e.target.x})).attr("y2",(function(e){return e.target.y})),t.select("line.mask").attr("x1",(function(e){return e.source.x})).attr("y1",(function(e){return e.source.y})).attr("x2",(function(e){return e.target.x})).attr("y2",(function(e){return e.target.y})),t.select("text").attr("text-anchor","middle").attr("transform",(function(e){return"translate(".concat((e.target.x+e.source.x)/2,", ").concat((e.source.y+e.target.y)/2,")")}))}},{key:"dragstarted",value:function(e){$.b.active||this.simulation.alpha(.3).restart(),e.fx=e.x,e.fy=e.y}},{key:"dragged",value:function(e){e.fx=$.b.x,e.fy=$.b.y}},{key:"dragended",value:function(e){$.b.active||this.simulation.alpha(0),e.fx=$.b.x,e.fy=$.b.y}},{key:"isTargetNode",value:function(e){var t=this.props.globalState,a=t.drugPredictions,n=t.selectedDisease;return a.filter((function(e){return e.selected})).map((function(e){return e.id})).includes(e.nodeId)||n===e.nodeId}},{key:"isHighlighted",value:function(e){var t=this.props.globalState.selectedPathNodes;return t.map((function(e){return e.nodeType})).includes(e.nodeType)&&t.map((function(e){return e.nodeId})).includes(e.nodeId)}},{key:"getNodeLinks",value:function(){var e=this,t=this.props.globalState,a=t.drugPredictions,n=t.attention,r=t.edgeThreshold,i=t.selectedDisease,o=t.edgeTypes,s=this.props,c=s.width,l=s.height,d=a.filter((function(e){return e.selected})).map((function(e){return e.id})),u=[],h=[];Object.values(n).forEach((function(t){var a=re(t,r),n=$.h(a),i=[];n.descendants().forEach((function(t){var a={id:"".concat(t.data.nodeType,":").concat(t.data.nodeId),nodeId:t.data.nodeId,nodeType:t.data.nodeType},n=e.prevNodes.find((function(e){return e.id===a.id}));i.push(Object(T.a)(Object(T.a)({},a),n))})),u=u.concat(i);var s=n.links().map((function(e){var t,a=e.source.data,n=e.target.data,r=n.edgeInfo.replace("rev_","");return r=(null===(t=o[r])||void 0===t?void 0:t.edgeInfo)||r,{source:"".concat(a.nodeType,":").concat(a.nodeId),target:"".concat(n.nodeType,":").concat(n.nodeId),score:n.score,edgeInfo:r}}));h=h.concat(s)}));for(var p=0;p<u.length;p++){var g=u[p],f=d.indexOf(g.nodeId);g.nodeId===i?(g.fy=l/2,g.fx=.2*c):f>-1&&(g.fy=l/(d.length+1)*(f+1),g.fx=.8*c)}return this.prevNodes=u,this.prevLinks=h,{nodes:u,links:h}}},{key:"drawGraph",value:function(){var e=this,t=this.props.globalState.nodeNameDict,a=this.getNodeLinks(),n=a.nodes,r=a.links,i=this.props,o=i.width,s=i.height,c=$.j().range([1,4]).domain($.c(r.map((function(e){return e.score})))),l=$.k("svg.graph").select("g.links").selectAll("g.link").data(r).join((function(e){return e.append("g").attr("class","link")})).on("mouseover",(function(){$.k(this).select("text.edgeLabel").transition().delay(500).attr("class","edgeLabel")})).on("mouseout",(function(){$.k(this).select("text.edgeLabel").transition().delay(500).attr("class","edgeLabel hidden")}));l.append("line").attr("x1",(function(e){return e.target.x})).attr("y1",(function(e){return e.target.y})).attr("x2",(function(e){return e.source.x})).attr("y2",(function(e){return e.source.y})).attr("class","link").attr("stroke","#aaa").attr("stroke-width",(function(e){return c(e.score)})).attr("id",(function(e){return e.id})),l.append("line").attr("x1",(function(e){return e.target.x})).attr("y1",(function(e){return e.target.y})).attr("x2",(function(e){return e.source.x})).attr("y2",(function(e){return e.source.y})).attr("class","mask").attr("stroke-width",4).attr("stroke","transparent"),l.append("text").attr("class","edgeLabel hidden").attr("transform",(function(e){return"translate(".concat((e.target.x+e.source.x)/2,", ").concat((e.source.y+e.target.y)/2,")")})).text((function(e){return e.edgeInfo}));var d=$.k("svg.graph").select("g.nodes").selectAll("g.nodeGroup").data(n,(function(e){return e.id})).join((function(t){return t.append("g").attr("class","nodeGroup").attr("transform",(function(e){return"translate(".concat(e.x||o/2,", ").concat(e.y||s/2,")")})).attr("cursor","pointer").call($.a().on("start",e.dragstarted.bind(e)).on("drag",e.dragged.bind(e)).on("end",e.dragended.bind(e)))}),(function(e){return e.attr("transform",(function(e){return"translate(".concat(e.x,", ").concat(e.y,")")}))}),(function(e){return e.remove()}));d.append("circle").attr("r",this.RADIUS).attr("class","node").attr("id",(function(e){return e.id})).attr("fill",(function(e){return te(e.nodeType)})).attr("stroke","white"),d.append("text").attr("class","nodeLabel").attr("transform","translate(".concat(-1*this.RADIUS,", ").concat(-2*this.RADIUS," )")).text((function(e){return t[e.nodeType][e.nodeId]})).classed("hidden",!0),d.filter((function(t){return e.isTargetNode(t)||e.isHighlighted(t)})).select("text.nodeLabel").classed("hidden",!1),d.on("click",(function(e){var t=$.k(this).select("text.nodeLabel"),a=t.classed("hidden");t.classed("hidden",!a)})),this.simulation.nodes(n),this.simulation.force("link").links(r),this.simulation.on("tick",(function(){return e.ticked(d,l)}))}},{key:"updateNodeLabel",value:function(){var e=this;$.k("svg.graph").select("g.nodes").selectAll("g.nodeGroup").filter((function(t){return e.isTargetNode(t)||e.isHighlighted(t)})).select("text.nodeLabel").classed("hidden",!1)}},{key:"componentDidMount",value:function(){this.drawGraph()}},{key:"componentDidUpdate",value:function(e){var t=e.globalState,a=t.metaPathGroups,n=t.selectedPathNodes,r=this.props.globalState,i=r.metaPathGroups,o=r.selectedPathNodes;return Object.keys(a).length!==Object.keys(i).length&&(this.drawGraph(),this.simulation.alpha(.5).restart()),n.map((function(e){return e.nodeId})).join()!==o.map((function(e){return e.nodeId})).join()&&this.updateNodeLabel(),!1}},{key:"render",value:function(){var e=this.props,t=e.width,a=e.height,r=Object.keys(this.props.globalState.metaPathGroups),i=n.createElement("text",{transform:"translate(".concat(t/2,", ").concat(a/2,")"),fill:"gray"},"Please select a drug first");return n.createElement("svg",{className:"graph",width:t,height:a},n.createElement("g",{className:"links"}),n.createElement("g",{className:"nodes"}),0===r.length?i:n.createElement(n.Fragment,null))}}]),a}(n.Component),ye=(a(163),a(273)),ve=K(function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).TITLE_HEIGHT=36,n.MARGIN=10,n.PADDING=10,n.EDGE_LENGTH=120,n.NODE_WIDTH=130,n.NODE_HEIGHT=25,n.VERTICAL_GAP=5,n.GROUP_GAP=10,n.COUNT_GAP=5,n.RADIUS=n.NODE_HEIGHT/2,n.HEAD_HEIGHT=70,n.ICON_GAP=20,n.offsetY=0,n.state={expand:n.props.globalState.metaPathSummary.map((function(e){return!1})),isModalVisible:!1},n.showModal=n.showModal.bind(Object(l.a)(n)),n.hideModal=n.hideModal.bind(Object(l.a)(n)),n.filterMetaPathGroups=n.filterMetaPathGroups.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"toggleExpand",value:function(e,t){var a=this.state.expand;a[e]=void 0===t?!a[e]:t,this.setState({expand:a})}},{key:"isPathSelected",value:function(e){var t=this.props.globalState.selectedPathNodes;return t.map((function(e){return e.nodeId})).join()===e.map((function(e){return e.nodeId})).join()&&t.map((function(e){return e.nodeType})).join()===e.map((function(e){return e.nodeType})).join()}},{key:"togglePathNodes",value:function(e,t){t?this.props.dispatch({type:R,payload:{selectedPathNodes:[]}}):this.props.dispatch({type:R,payload:{selectedPathNodes:e}})}},{key:"getMetaIconGroup",value:function(e,t){return r.a.createElement("g",{className:"feedback",cursor:"pointer",style:{fill:"#777"},transform:"translate(5, 0)"},r.a.createElement("g",{className:"yes",transform:"translate(".concat(0*this.ICON_GAP,", 0)"),onClick:function(){return e(!t)}},r.a.createElement("rect",{width:this.ICON_GAP,height:this.ICON_GAP,fill:"white"}),r.a.createElement("path",{d:t?"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z":"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z",transform:"scale(0.03)"})))}},{key:"getIconGroup",value:function(e){this.isPathSelected(e);return r.a.createElement("g",{className:"feedback",cursor:"pointer",style:{fill:"#777"}})}},{key:"drawHeader",value:function(){var e=this,t=this.props.globalState,a=t.drugPredictions,n=t.nodeNameDict,i=a.map((function(e){return n.drug[e.id]}));return i.push("SUM"),i.map((function(t,n){var i=!(n>a.length-1)&&a[n].selected;return r.a.createElement("text",{key:t,className:t,fill:i?"dark":"gray",cursor:"pointer",transform:"translate(\n            ".concat(n*(2*e.RADIUS+e.COUNT_GAP)+e.RADIUS,", \n            ").concat(e.HEAD_HEIGHT,") \n            rotate(-45)"),onClick:function(){n<a.length&&e.onChangeDrug(a[n].id)}},t)}))}},{key:"getCountWidth",value:function(){return(this.props.globalState.drugPredictions.length+1)*(2*this.RADIUS+this.COUNT_GAP)+this.COUNT_GAP}},{key:"drawSummary",value:function(){var e=this,t=this.EDGE_LENGTH,a=this.NODE_WIDTH,n=this.NODE_HEIGHT,i=this.VERTICAL_GAP,o=this.props.globalState,s=o.metaPathSummary,c=o.drugPredictions,l=this.getCountWidth(),d=this.filterMetaPathGroups(),u=Math.max.apply(Math,Object(pe.a)(s.map((function(e){return e.count})).flat())),h=$.j().range([this.RADIUS/3,this.RADIUS]).domain([0,u]);this.offsetY=0;var p=Object(pe.a)(s).sort((function(e,t){return(e.hide?1:0)-(t.hide?1:0)})).map((function(o){var u=o.nodeTypes.map((function(i,o){var s="translate(".concat((t+a)*o,", ",0,")");return r.a.createElement("g",{key:"node_".concat(o),transform:s},r.a.createElement("rect",{width:a,height:n,fill:"white",strokeWidth:"3",stroke:te(i),rx:e.NODE_HEIGHT/2}),r.a.createElement("text",{textAnchor:"middle",y:n/2+6,x:a/2,fill:"black"},i))})),p=Object(pe.a)(Array(u.length-1)).map((function(e,i){var o="translate(".concat(a+(t+a)*i,", ").concat(+n/2,")");return r.a.createElement("g",{key:"edge_".concat(i),transform:o},r.a.createElement("line",{stroke:"lightgray",strokeWidth:2,x1:0,y1:0,x2:t,y2:0}))})),g=e.offsetY;e.offsetY+=n+i;var f=[],m=0,y=e.state.expand[o.idx],v=void 0;Object.keys(d).forEach((function(t){var a,s=(null===(a=d[t].filter((function(e){return e.nodeTypes.join("")===o.nodeTypes.join("")}))[0])||void 0===a?void 0:a.metaPaths)||[],l=c.map((function(e){return e.id})).indexOf(t),u=e.drawChildrenPaths(s,l,v);v=s[s.length-1];var h=(n+i)*s.length;f.push(r.a.createElement("g",{key:"drugRank: ".concat(l),className:"drugRank_".concat(l),transform:"translate(0, ".concat(m,")")},u)),m+=h,y&&(e.offsetY+=h),e.offsetY+=e.GROUP_GAP}));return r.a.createElement("g",{key:"prototype_".concat(o.idx),transform:"translate(".concat(0,", ",g,")"),opacity:o.hide?.4:1},r.a.createElement("g",{className:"metaCount"},e.drawMetaCount(o,h)),r.a.createElement("g",{className:"icon"},r.a.createElement("path",{d:y?"M 6.414 9 h 11.172 a 1 1 0 0 1 0.707 1.707 l -5.586 5.586 a 1 1 0 0 1 -1.414 0 l -5.586 -5.586 A 1 1 0 0 1 6.414 9 Z":"M 9 17.879 V 6.707 A 1 1 0 0 1 10.707 6 l 5.586 5.586 a 1 1 0 0 1 0 1.414 l -5.586 5.586 A 1 1 0 0 1 9 17.879 Z",transform:"translate(".concat(l,", 0)"),fill:"gray",onClick:function(){o.hide||e.toggleExpand(o.idx,void 0)},cursor:"pointer"})),r.a.createElement("g",{className:"prototype",transform:"translate(".concat(l+e.ICON_GAP,", 0)")},u,p,r.a.createElement("g",{className:"iconGroup",transform:"translate(".concat(a*u.length+t*p.length,", 0)")},e.getMetaIconGroup((function(t){!function(e,t,a,n){e[t].hide=a,n({type:U,payload:{metaPathSummary:e}})}(s,o.idx,t,e.props.dispatch),t&&e.toggleExpand(o.idx,!1)}),o.hide))),r.a.createElement("g",{className:"metapaths"},y?f:r.a.createElement("g",null)))})),g=this.drawHeader();return r.a.createElement("g",null,r.a.createElement("g",{className:"header",transform:"translate(".concat(this.PADDING,", ").concat(this.PADDING,")")},g),r.a.createElement("g",{className:"rows",transform:"translate(".concat(0,", ",this.PADDING+this.HEAD_HEIGHT,")")},p))}},{key:"onChangeDrug",value:function(e){var t=F(this.props.globalState.drugPredictions,e);W(e,this.props.globalState.selectedDisease,t,this.props.dispatch)}},{key:"componentDidUpdate",value:function(e){if(e.globalState.selectedDisease!==this.props.globalState.selectedDisease)this.setState({expand:this.props.globalState.metaPathSummary.map((function(e){return!1}))});else if(e.globalState.drugPredictions.filter((function(e){return e.selected})).length!==this.props.globalState.drugPredictions.filter((function(e){return e.selected})).length){var t=this.props.globalState,a=t.metaPathSummary,n=t.drugPredictions,r=a.map((function(e){return e.count.reduce((function(e,t,a){return e+t*(n[a].selected?1:0)}),0)>0&&!e.hide}));this.setState({expand:r})}}},{key:"drawMetaCount",value:function(e,t){var a=this,n=this.props.globalState.drugPredictions,i=e.count,o=e.sum,s=i.map((function(e,i){var o=n[i].selected,s=0===e?r.a.createElement("line",{x1:.5*a.RADIUS,x2:1.5*a.RADIUS,stroke:o?"dark":"lightgray"}):r.a.createElement(r.a.Fragment,null,r.a.createElement("circle",{r:t(e),fill:o?"dark":"lightgray",xlinkTitle:e.toString(),cx:a.RADIUS}),r.a.createElement("text",{textAnchor:"middle",transform:"\n                translate(".concat(a.RADIUS,", ").concat(t(e)/2,") \n              scale(").concat(t(e)/a.RADIUS,")\n              "),fill:o?"white":"black"},e));return r.a.createElement("g",{key:i,className:"count",transform:"translate(".concat(i*(2*a.RADIUS+a.COUNT_GAP),", ").concat(a.NODE_HEIGHT/2,")"),cursor:"pointer",onClick:function(){return a.onChangeDrug(n[i].id)}},s)}));return r.a.createElement("g",{className:"metaCount",transform:"translate(".concat(this.PADDING,", 0)")},s,r.a.createElement("g",{className:"sum",transform:"translate(".concat(i.length*(2*this.RADIUS+this.COUNT_GAP),", 0)")},r.a.createElement("text",{x:this.RADIUS,y:this.NODE_HEIGHT/2+6,textAnchor:"middle"}," ","| ".concat(o)," ")))}},{key:"drawChildrenPaths",value:function(e,t,a){var n=this,i=this.props.globalState,o=i.nodeNameDict,s=i.edgeTypes,c=this.getCountWidth();return e.map((function(i,l){var d=i.nodes.map((function(t,i){var s=t.nodeId,c=t.nodeType,d=o[c][s],u="";if(l>0&&(a=e[l-1]),void 0!==a){var h=a.nodes[i],p=h.nodeId,g=h.nodeType;u=o[g][p]}var f=d===u?"\u3003":ae(d,14,n.NODE_WIDTH-10)||"undefined",m="translate(".concat((n.EDGE_LENGTH+n.NODE_WIDTH)*i,", ",0,")");return r.a.createElement(ge.a,{key:"node_".concat(i),title:f.includes(".")?d:""},r.a.createElement("g",{transform:m,className:"node_".concat(s),style:{cursor:"pointer"},onClick:function(){return"drug"===c&&window.open("https://go.drugbank.com/drugs/".concat(s),"windowName","popup,right=10,top=10,width=320,height=600")}},r.a.createElement("rect",{width:n.NODE_WIDTH,height:n.NODE_HEIGHT,fill:te(c)}),r.a.createElement("text",{textAnchor:"middle",y:n.NODE_HEIGHT/2+6,x:n.NODE_WIDTH/2,fill:"white"},f)))})),u=i.edges.map((function(e,t){var a,i="translate(".concat(n.NODE_WIDTH+(n.EDGE_LENGTH+n.NODE_WIDTH)*t,", ").concat(+n.NODE_HEIGHT/2,")"),o=e.edgeInfo.replace("rev_","");o=(null===(a=s[o])||void 0===a?void 0:a.edgeInfo)||o;var c=ae(o,14,n.EDGE_LENGTH);return r.a.createElement(ge.a,{title:c===o?"":o,destroyTooltipOnHide:!0},r.a.createElement("g",{key:"edge_".concat(t),transform:i,style:{cursor:"pointer"}},r.a.createElement("line",{stroke:"gray",strokeWidth:1+.7*e.score,x1:0,y1:n.NODE_HEIGHT/4,x2:n.EDGE_LENGTH,y2:n.NODE_HEIGHT/4}),r.a.createElement("text",{x:n.EDGE_LENGTH/2,y:0,textAnchor:"middle"},o)))}));return r.a.createElement("g",{key:l,transform:"translate(0, ".concat((n.NODE_HEIGHT+n.VERTICAL_GAP)*(1+l),")")},r.a.createElement("circle",{cx:t*(2*n.RADIUS+n.COUNT_GAP)+n.RADIUS+n.PADDING,cy:n.NODE_HEIGHT/2,fill:"dark",r:n.RADIUS/3}),r.a.createElement("g",{transform:"translate(".concat(c+n.ICON_GAP,", 0)")},d,u,r.a.createElement("g",{className:"iconGroup",transform:"translate(".concat(n.NODE_WIDTH*d.length+n.EDGE_LENGTH*u.length,", 0)")},n.getIconGroup(i.nodes))))}))}},{key:"showModal",value:function(){this.setState({isModalVisible:!0})}},{key:"hideModal",value:function(){this.setState({isModalVisible:!1})}},{key:"filterMetaPathGroups",value:function(){var e=this.props.globalState,t=e.metaPathGroups,a=e.edgeThreshold,n={};return Object.keys(t).forEach((function(e){n[e]=t[e].map((function(e){var t=e.metaPaths.filter((function(e){return e.edges.every((function(e){return e.score>a}))}));return Object(T.a)(Object(T.a)({},e),{},{metaPaths:t})}))})),Object.keys(n).forEach((function(e){n[e]=n[e].filter((function(e){return e.metaPaths.length>0}))})),n}},{key:"render",value:function(){var e=this.props,t=e.width,a=e.height,n=this.state.isModalVisible,i=this.props.globalState,o=i.isDrugLoading,s=i.isAttentionLoading,c=i.metaPathSummary,l=i.selectedDisease,d=Math.max(t-2*this.PADDING-2*this.MARGIN,this.getCountWidth()+5*this.ICON_GAP+this.NODE_WIDTH+4*(this.EDGE_LENGTH+this.NODE_WIDTH)),u=a-2*this.PADDING-this.TITLE_HEIGHT,h=Math.max(this.offsetY+this.NODE_HEIGHT+this.VERTICAL_GAP+this.PADDING+this.HEAD_HEIGHT,u),p=r.a.createElement("text",{x:t/2,y:a/2,fill:"gray"},o||s?"":l?"There is no meta path":"Please select a disease first"),g=this.drawSummary(),f=0===c.length?p:g;return r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{width:d,height:h},f,o||s&&this.state.expand.some((function(e){return e}))?r.a.createElement("g",{transform:"translate(".concat(d/2,", ").concat(u/2,")")},ne):r.a.createElement(r.a.Fragment,null)),r.a.createElement(ye.a,{title:"Edit Explanation",visible:n,onOk:this.hideModal,onCancel:this.hideModal,okText:"Confirm",width:t,zIndex:1999},r.a.createElement("svg",{width:t})))}}]),a}(r.a.Component)),be=he.a.TabPane,Ee=K(function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).titleHeight=36,n.margin=10,n.padding=10,n.state={activeTab:"metapath"},n}return Object(c.a)(a,[{key:"changeActiveTab",value:function(e){this.setState({activeTab:e})}},{key:"render",value:function(){var e=this.props,t=e.width,a=e.height,n=t-2*this.margin-2*this.padding,i=a-2*this.padding-this.titleHeight-2*this.margin,o=Object(T.a)(Object(T.a)({},this.props),{},{height:i,width:n});return r.a.createElement(he.a,{size:"small",activeKey:this.state.activeTab,style:{width:t-2*this.margin,height:a-2*this.margin,margin:this.margin,backgroundColor:"white"},tabBarStyle:{height:this.titleHeight,padding:"0px 10px",margin:"0px"},onChange:this.changeActiveTab.bind(this)},r.a.createElement(be,{style:{padding:this.padding},key:"metapath",tab:"Meta-Path"},r.a.createElement("div",{className:"nodelink",style:{width:n,height:i,overflowY:"scroll"}},r.a.createElement(ve,o))),r.a.createElement(be,{style:{padding:this.padding},key:"attention",tab:"Node Attention"},r.a.createElement("div",{className:"nodelink",style:{width:n,height:i,overflowY:"scroll"}},r.a.createElement(fe,o))),r.a.createElement(be,{style:{padding:this.padding},key:"graph",tab:"Sub-Graph"},r.a.createElement("div",{className:"nodelink",style:{width:n,height:i,overflowY:"scroll"}},r.a.createElement(me,o))))}}]),a}(r.a.Component)),Oe=(a(267),a(277)),ke=a(275),De=a(91),xe=a(46),_e=a(274),Te=a(276),Ne=Oe.a.Sider,we=ke.a.Option,Ie=K(function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).padding=10,n.listHeight=150,n.changeEdgeTHR=n.changeEdgeTHR.bind(Object(l.a)(n)),n.onChangeDisease=n.onChangeDisease.bind(Object(l.a)(n)),n.onChangeDrug=n.onChangeDrug.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"onChangeDrug",value:function(e){var t=this.props.globalState.drugPredictions.filter((function(e){return e.selected})).map((function(e){return e.id})),a=e.length>t.length,n=a?e[e.length-1]:t.filter((function(t){return!e.includes(t)}))[0];W(n,this.props.globalState.selectedDisease,a,this.props.dispatch)}},{key:"changeEdgeTHR",value:function(e){"number"==typeof e&&this.props.dispatch({type:L,payload:{edgeThreshold:e}})}},{key:"onChangeDisease",value:function(e){!function(e,t){t({type:H,payload:{isDrugLoading:!0}}),t({type:M,payload:{selectedDisease:e}}),t({type:C,payload:{selectedDrug:void 0}}),x(e).then((function(e){var a=e.predictions,n=e.metapathSummary,r=a.map((function(e){return Object(T.a)(Object(T.a)({},e),{},{selected:!1})}));t({type:G,payload:{drugPredictions:r,metaPathSummary:n}})})).then((function(){t({type:H,payload:{isDrugLoading:!1}})}))}(e,this.props.dispatch)}},{key:"render",value:function(){var e=this.props.siderWidth,t=this.props.globalState,a=t.edgeThreshold,n=t.nodeTypes,i=t.diseaseOptions,o=t.drugPredictions,s=t.nodeNameDict,c=t.selectedDisease,l=o.filter((function(e){return e.selected})).map((function(e){return e.id}));return r.a.createElement(Ne,{width:e,theme:"light",style:{padding:"".concat(this.padding,"px")}},"Disease:",r.a.createElement(ke.a,{defaultValue:"Select a disease",style:{width:e-2*this.padding},onChange:this.onChangeDisease,showSearch:!0,optionFilterProp:"label"},i.length>0?i.map((function(e){var t=s.disease[e];return r.a.createElement(we,{value:e,label:t,key:"diseaseID_".concat(e)},t)})):r.a.createElement(we,{value:"loading",label:"loading",key:"loading"},"data is loading..")),r.a.createElement("br",null),"Drug:",r.a.createElement(ke.a,{mode:"multiple",style:{width:e-2*this.padding},open:!0,showSearch:!0,optionFilterProp:"label",listHeight:this.listHeight,onChange:this.onChangeDrug,placeholder:"Select a drug from the prediction",value:l},void 0!==c?o.length>0?o.map((function(e,t){var a=e.id,n=(e.score,s.drug[a]);return r.a.createElement(we,{value:a,key:"disease_".concat(t),label:n},r.a.createElement("div",null,r.a.createElement("span",null,n),r.a.createElement("span",{style:{float:"right"}},"rank: ",t+1)))})):r.a.createElement(we,{value:"loading",label:"loading",key:"loading"},"data is loading.."):r.a.createElement(we,{value:"noDisease",label:"noDisease",key:"noDisease"},"please select a disease first")),r.a.createElement("div",{className:"dummy",style:{height:this.listHeight+20}}),"Edge Threshold:",r.a.createElement(De.a,null,r.a.createElement(xe.a,{span:16},r.a.createElement(_e.a,{step:.1,value:a,min:0,max:1.5,onChange:this.changeEdgeTHR})),r.a.createElement(xe.a,{span:4},r.a.createElement(Te.a,{value:a,onChange:this.changeEdgeTHR,step:.1}))),r.a.createElement("div",{className:"nodeTypes"},"Node Types:",r.a.createElement("br",null),n.map((function(e){return r.a.createElement("div",{key:e,style:{marginLeft:"5px"}},r.a.createElement("span",{style:{background:te(e),color:"white",padding:"2px"}},e))}))),r.a.createElement("br",null),r.a.createElement("br",null))}}]),a}(r.a.Component)),je=(a(268),Oe.a.Header),Se=(Oe.a.Footer,Oe.a.Content),Pe=K(function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={width:window.innerWidth,height:window.innerHeight},n.updateSize=n.updateSize.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"updateSize",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.updateSize),b().then((function(t){!function(e){ee={},e.forEach((function(e,t){t>Q.length-1&&(t%=Q.length-1),ee[e]=Q[t]}))}(t),e.props.dispatch({type:w,payload:{nodeTypes:t}})})).then((function(){return E()})).then((function(t){e.props.dispatch({type:I,payload:{edgeTypes:t}})})).then((function(){return O()})).then((function(t){e.props.dispatch({type:P,payload:{nodeNameDict:t}})})).then((function(){return D()})).then((function(t){e.props.dispatch({type:A,payload:{diseaseOptions:t}})}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateSize)}},{key:"render",value:function(){var e=window.innerWidth-300,t=window.innerHeight-64,a=.55*t,n=t-a,i=r.a.createElement(je,{className:"header",style:{height:64}},"DrugExplorer");return r.a.createElement(Oe.a,null,i,r.a.createElement(Oe.a,null,r.a.createElement(Ie,{siderWidth:300}),r.a.createElement(Se,{className:"main",style:{height:t}},r.a.createElement(ue,{width:e,height:n}),r.a.createElement(Ee,{width:e,height:a}))))}}]),a}(r.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(269);o.a.render(r.a.createElement(q,null,r.a.createElement(r.a.StrictMode,null,r.a.createElement(Pe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[237,1,2]]]);
//# sourceMappingURL=main.eb72353a.chunk.js.map